{"ast":null,"code":"import _slicedToArray from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _regeneratorRuntime from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";\nimport _asyncToGenerator from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport _classCallCheck from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";\nimport _createClass from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/createClass.js\";\nimport _assertThisInitialized from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";\nimport _inherits from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/inherits.js\";\nimport _createSuper from \"C:/Users/danie/OneDrive/Desktop/work on this/node_modules/@babel/runtime/helpers/esm/createSuper.js\";\nimport { l as Connector, _ as _classPrivateMethodInitSpec, t as _defineProperty, u as _classPrivateFieldInitSpec, n as normalizeChainId, U as UserRejectedRequestError, v as _classPrivateFieldGet, w as _classPrivateFieldSet, m as ChainNotConfiguredError, x as _classPrivateMethodGet, A as AddChainError, q as SwitchChainError } from '../../../dist/getProvider-f1dfc7e3.esm.js';\nimport { providers } from 'ethers';\nimport { getAddress, hexValue } from 'ethers/lib/utils';\nimport 'zustand/middleware';\nimport 'zustand/vanilla';\nimport 'eventemitter3';\nimport '../../../dist/chains-8c76af1b.esm.js';\nimport '../../../dist/rpcs-8d636858.esm.js';\n\nvar _client = /*#__PURE__*/new WeakMap();\n\nvar _provider = /*#__PURE__*/new WeakMap();\n\nvar _isUserRejectedRequestError = /*#__PURE__*/new WeakSet();\n\nvar CoinbaseWalletConnector = /*#__PURE__*/function (_Connector) {\n  _inherits(CoinbaseWalletConnector, _Connector);\n\n  var _super = _createSuper(CoinbaseWalletConnector);\n\n  function CoinbaseWalletConnector(_ref) {\n    var _this;\n\n    _classCallCheck(this, CoinbaseWalletConnector);\n\n    var chains = _ref.chains,\n        options = _ref.options;\n    _this = _super.call(this, {\n      chains: chains,\n      options: _objectSpread({\n        reloadOnDisconnect: false\n      }, options)\n    });\n\n    _classPrivateMethodInitSpec(_assertThisInitialized(_this), _isUserRejectedRequestError);\n\n    _defineProperty(_assertThisInitialized(_this), \"id\", 'coinbaseWallet');\n\n    _defineProperty(_assertThisInitialized(_this), \"name\", 'Coinbase Wallet');\n\n    _defineProperty(_assertThisInitialized(_this), \"ready\", true);\n\n    _classPrivateFieldInitSpec(_assertThisInitialized(_this), _client, {\n      writable: true,\n      value: void 0\n    });\n\n    _classPrivateFieldInitSpec(_assertThisInitialized(_this), _provider, {\n      writable: true,\n      value: void 0\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onAccountsChanged\", function (accounts) {\n      if (accounts.length === 0) _this.emit('disconnect');else _this.emit('change', {\n        account: getAddress(accounts[0])\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChainChanged\", function (chainId) {\n      var id = normalizeChainId(chainId);\n\n      var unsupported = _this.isChainUnsupported(id);\n\n      _this.emit('change', {\n        chain: {\n          id: id,\n          unsupported: unsupported\n        }\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onDisconnect\", function () {\n      _this.emit('disconnect');\n    });\n\n    return _this;\n  }\n\n  _createClass(CoinbaseWalletConnector, [{\n    key: \"connect\",\n    value: function () {\n      var _connect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee() {\n        var _ref3,\n            chainId,\n            provider,\n            accounts,\n            account,\n            id,\n            unsupported,\n            chain,\n            _args = arguments;\n\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _ref3 = _args.length > 0 && _args[0] !== undefined ? _args[0] : {}, chainId = _ref3.chainId;\n                _context.prev = 1;\n                _context.next = 4;\n                return this.getProvider();\n\n              case 4:\n                provider = _context.sent;\n                provider.on('accountsChanged', this.onAccountsChanged);\n                provider.on('chainChanged', this.onChainChanged);\n                provider.on('disconnect', this.onDisconnect);\n                this.emit('message', {\n                  type: 'connecting'\n                });\n                _context.next = 11;\n                return provider.enable();\n\n              case 11:\n                accounts = _context.sent;\n                account = getAddress(accounts[0]); // Switch to chain if provided\n\n                _context.next = 15;\n                return this.getChainId();\n\n              case 15:\n                id = _context.sent;\n                unsupported = this.isChainUnsupported(id);\n\n                if (!(chainId && id !== chainId)) {\n                  _context.next = 23;\n                  break;\n                }\n\n                _context.next = 20;\n                return this.switchChain(chainId);\n\n              case 20:\n                chain = _context.sent;\n                id = chain.id;\n                unsupported = this.isChainUnsupported(id);\n\n              case 23:\n                return _context.abrupt(\"return\", {\n                  account: account,\n                  chain: {\n                    id: id,\n                    unsupported: unsupported\n                  },\n                  provider: new providers.Web3Provider(provider)\n                });\n\n              case 26:\n                _context.prev = 26;\n                _context.t0 = _context[\"catch\"](1);\n\n                if (!/(user closed modal|accounts received is empty)/i.test(_context.t0.message)) {\n                  _context.next = 30;\n                  break;\n                }\n\n                throw new UserRejectedRequestError(_context.t0);\n\n              case 30:\n                throw _context.t0;\n\n              case 31:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[1, 26]]);\n      }));\n\n      function connect() {\n        return _connect.apply(this, arguments);\n      }\n\n      return connect;\n    }()\n  }, {\n    key: \"disconnect\",\n    value: function () {\n      var _disconnect = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var provider;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (_classPrivateFieldGet(this, _provider)) {\n                  _context2.next = 2;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\");\n\n              case 2:\n                _context2.next = 4;\n                return this.getProvider();\n\n              case 4:\n                provider = _context2.sent;\n                provider.removeListener('accountsChanged', this.onAccountsChanged);\n                provider.removeListener('chainChanged', this.onChainChanged);\n                provider.removeListener('disconnect', this.onDisconnect);\n                provider.disconnect();\n                provider.close();\n\n              case 10:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function disconnect() {\n        return _disconnect.apply(this, arguments);\n      }\n\n      return disconnect;\n    }()\n  }, {\n    key: \"getAccount\",\n    value: function () {\n      var _getAccount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var provider, accounts;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                _context3.next = 2;\n                return this.getProvider();\n\n              case 2:\n                provider = _context3.sent;\n                _context3.next = 5;\n                return provider.request({\n                  method: 'eth_accounts'\n                });\n\n              case 5:\n                accounts = _context3.sent;\n                return _context3.abrupt(\"return\", getAddress(accounts[0]));\n\n              case 7:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getAccount() {\n        return _getAccount.apply(this, arguments);\n      }\n\n      return getAccount;\n    }()\n  }, {\n    key: \"getChainId\",\n    value: function () {\n      var _getChainId = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        var provider, chainId;\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                _context4.next = 2;\n                return this.getProvider();\n\n              case 2:\n                provider = _context4.sent;\n                chainId = normalizeChainId(provider.chainId);\n                return _context4.abrupt(\"return\", chainId);\n\n              case 5:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function getChainId() {\n        return _getChainId.apply(this, arguments);\n      }\n\n      return getChainId;\n    }()\n  }, {\n    key: \"getProvider\",\n    value: function () {\n      var _getProvider = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var _this2 = this;\n\n        var _walletExtension, CoinbaseWalletSDK, walletExtensionChainId, chain, chainId, jsonRpcUrl;\n\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) {\n            switch (_context5.prev = _context5.next) {\n              case 0:\n                if (_classPrivateFieldGet(this, _provider)) {\n                  _context5.next = 11;\n                  break;\n                }\n\n                _context5.next = 3;\n                return import('@coinbase/wallet-sdk');\n\n              case 3:\n                CoinbaseWalletSDK = _context5.sent.default;\n                // Workaround for Vite dev import errors\n                // https://github.com/vitejs/vite/issues/7112\n                if (typeof CoinbaseWalletSDK !== 'function' && // @ts-expect-error This import error is not visible to TypeScript\n                typeof CoinbaseWalletSDK.default === 'function') CoinbaseWalletSDK = CoinbaseWalletSDK.default;\n\n                _classPrivateFieldSet(this, _client, new CoinbaseWalletSDK(this.options));\n\n                walletExtensionChainId = (_walletExtension = _classPrivateFieldGet(this, _client).walletExtension) === null || _walletExtension === void 0 ? void 0 : _walletExtension.getChainId();\n                chain = this.chains.find(function (chain) {\n                  return _this2.options.chainId ? chain.id === _this2.options.chainId : chain.id === walletExtensionChainId;\n                }) || this.chains[0];\n                chainId = this.options.chainId || (chain === null || chain === void 0 ? void 0 : chain.id);\n                jsonRpcUrl = this.options.jsonRpcUrl || (chain === null || chain === void 0 ? void 0 : chain.rpcUrls.default);\n\n                _classPrivateFieldSet(this, _provider, _classPrivateFieldGet(this, _client).makeWeb3Provider(jsonRpcUrl, chainId));\n\n              case 11:\n                return _context5.abrupt(\"return\", _classPrivateFieldGet(this, _provider));\n\n              case 12:\n              case \"end\":\n                return _context5.stop();\n            }\n          }\n        }, _callee5, this);\n      }));\n\n      function getProvider() {\n        return _getProvider.apply(this, arguments);\n      }\n\n      return getProvider;\n    }()\n  }, {\n    key: \"getSigner\",\n    value: function () {\n      var _getSigner = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6() {\n        var _yield$Promise$all, _yield$Promise$all2, provider, account;\n\n        return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.next = 2;\n                return Promise.all([this.getProvider(), this.getAccount()]);\n\n              case 2:\n                _yield$Promise$all = _context6.sent;\n                _yield$Promise$all2 = _slicedToArray(_yield$Promise$all, 2);\n                provider = _yield$Promise$all2[0];\n                account = _yield$Promise$all2[1];\n                return _context6.abrupt(\"return\", new providers.Web3Provider(provider).getSigner(account));\n\n              case 7:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function getSigner() {\n        return _getSigner.apply(this, arguments);\n      }\n\n      return getSigner;\n    }()\n  }, {\n    key: \"isAuthorized\",\n    value: function () {\n      var _isAuthorized = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7() {\n        var account;\n        return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                _context7.prev = 0;\n                _context7.next = 3;\n                return this.getAccount();\n\n              case 3:\n                account = _context7.sent;\n                return _context7.abrupt(\"return\", !!account);\n\n              case 7:\n                _context7.prev = 7;\n                _context7.t0 = _context7[\"catch\"](0);\n                return _context7.abrupt(\"return\", false);\n\n              case 10:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this, [[0, 7]]);\n      }));\n\n      function isAuthorized() {\n        return _isAuthorized.apply(this, arguments);\n      }\n\n      return isAuthorized;\n    }()\n  }, {\n    key: \"switchChain\",\n    value: function () {\n      var _switchChain = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(chainId) {\n        var provider, id, _this$chains$find, chain, _chain$rpcUrls$public;\n\n        return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                _context8.next = 2;\n                return this.getProvider();\n\n              case 2:\n                provider = _context8.sent;\n                id = hexValue(chainId);\n                _context8.prev = 4;\n                _context8.next = 7;\n                return provider.request({\n                  method: 'wallet_switchEthereumChain',\n                  params: [{\n                    chainId: id\n                  }]\n                });\n\n              case 7:\n                return _context8.abrupt(\"return\", (_this$chains$find = this.chains.find(function (x) {\n                  return x.id === chainId;\n                })) !== null && _this$chains$find !== void 0 ? _this$chains$find : {\n                  id: chainId,\n                  name: \"Chain \".concat(id),\n                  network: \"\".concat(id),\n                  rpcUrls: {\n                    default: ''\n                  }\n                });\n\n              case 10:\n                _context8.prev = 10;\n                _context8.t0 = _context8[\"catch\"](4);\n                chain = this.chains.find(function (x) {\n                  return x.id === chainId;\n                });\n\n                if (chain) {\n                  _context8.next = 15;\n                  break;\n                }\n\n                throw new ChainNotConfiguredError();\n\n              case 15:\n                if (!(_context8.t0.code === 4902)) {\n                  _context8.next = 27;\n                  break;\n                }\n\n                _context8.prev = 16;\n                _context8.next = 19;\n                return provider.request({\n                  method: 'wallet_addEthereumChain',\n                  params: [{\n                    chainId: id,\n                    chainName: chain.name,\n                    nativeCurrency: chain.nativeCurrency,\n                    rpcUrls: [(_chain$rpcUrls$public = chain.rpcUrls.public) !== null && _chain$rpcUrls$public !== void 0 ? _chain$rpcUrls$public : chain.rpcUrls.default],\n                    blockExplorerUrls: this.getBlockExplorerUrls(chain)\n                  }]\n                });\n\n              case 19:\n                return _context8.abrupt(\"return\", chain);\n\n              case 22:\n                _context8.prev = 22;\n                _context8.t1 = _context8[\"catch\"](16);\n\n                if (!_classPrivateMethodGet(this, _isUserRejectedRequestError, _isUserRejectedRequestError2).call(this, _context8.t1)) {\n                  _context8.next = 26;\n                  break;\n                }\n\n                throw new UserRejectedRequestError(_context8.t1);\n\n              case 26:\n                throw new AddChainError();\n\n              case 27:\n                if (!_classPrivateMethodGet(this, _isUserRejectedRequestError, _isUserRejectedRequestError2).call(this, _context8.t0)) {\n                  _context8.next = 29;\n                  break;\n                }\n\n                throw new UserRejectedRequestError(_context8.t0);\n\n              case 29:\n                throw new SwitchChainError(_context8.t0);\n\n              case 30:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this, [[4, 10], [16, 22]]);\n      }));\n\n      function switchChain(_x) {\n        return _switchChain.apply(this, arguments);\n      }\n\n      return switchChain;\n    }()\n  }, {\n    key: \"watchAsset\",\n    value: function () {\n      var _watchAsset = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(_ref2) {\n        var address, _ref2$decimals, decimals, image, symbol, provider;\n\n        return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                address = _ref2.address, _ref2$decimals = _ref2.decimals, decimals = _ref2$decimals === void 0 ? 18 : _ref2$decimals, image = _ref2.image, symbol = _ref2.symbol;\n                _context9.next = 3;\n                return this.getProvider();\n\n              case 3:\n                provider = _context9.sent;\n                _context9.next = 6;\n                return provider.request({\n                  method: 'wallet_watchAsset',\n                  params: {\n                    type: 'ERC20',\n                    options: {\n                      address: address,\n                      decimals: decimals,\n                      image: image,\n                      symbol: symbol\n                    }\n                  }\n                });\n\n              case 6:\n                return _context9.abrupt(\"return\", _context9.sent);\n\n              case 7:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function watchAsset(_x2) {\n        return _watchAsset.apply(this, arguments);\n      }\n\n      return watchAsset;\n    }()\n  }]);\n\n  return CoinbaseWalletConnector;\n}(Connector);\n\nfunction _isUserRejectedRequestError2(error) {\n  return /(user rejected)/i.test(error.message);\n}\n\nexport { CoinbaseWalletConnector };","map":null,"metadata":{},"sourceType":"module"}